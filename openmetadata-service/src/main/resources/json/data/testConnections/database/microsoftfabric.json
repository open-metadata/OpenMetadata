{
  "name": "MicrosoftFabric",
  "displayName": "Microsoft Fabric Test Connection",
  "description": "This Test Connection validates the access against the Microsoft Fabric Warehouse/Lakehouse and basic metadata extraction of schemas and tables.",
  "steps": [
    {
      "name": "CheckAccess",
      "description": "Validate that we can properly reach the Microsoft Fabric Warehouse and authenticate with the given Service Principal credentials.",
      "errorMessage": "Failed to connect to Microsoft Fabric Warehouse, please validate the Service Principal credentials (clientId, clientSecret, tenantId) and ensure the hostPort is correct.",
      "shortCircuit": true,
      "mandatory": true
    },
    {
      "name": "GetSchemas",
      "description": "List all the schemas available to the Service Principal.",
      "errorMessage": "Failed to fetch schemas, please validate if the Service Principal has enough privilege to fetch schemas.",
      "mandatory": true
    },
    {
      "name": "GetTables",
      "description": "From a given schema, list the tables belonging to that schema. If no schema is specified, we'll list the tables of a random schema.",
      "errorMessage": "Failed to fetch tables, please validate if the Service Principal has enough privilege to fetch tables.",
      "mandatory": true
    },
    {
      "name": "GetViews",
      "description": "From a given schema, list the views belonging to that schema. If no schema is specified, we'll list the views of a random schema.",
      "errorMessage": "Failed to fetch views, please validate if the Service Principal has enough privilege to fetch views.",
      "mandatory": false
    }
  ]
}
