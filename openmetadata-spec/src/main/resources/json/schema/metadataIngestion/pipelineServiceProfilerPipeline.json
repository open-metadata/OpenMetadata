{
  "$id": "https://open-metadata.org/schema/metadataIngestion/pipelineServiceProfilerPipeline.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "PipelineServiceProfilerPipeline",
  "description": "PipelineService Profiler Pipeline Configuration.",
  "type": "object",
  "definitions": {
    "pipelineProfilerConfigType": {
      "description": "Pipeline Source Config Profiler Pipeline type",
      "type": "string",
      "enum": ["PipelineProfiler"],
      "default": "PipelineProfiler"
    }
  },
  "properties": {
    "type": {
      "description": "Pipeline profiler type",
      "$ref": "#/definitions/pipelineProfilerConfigType",
      "default": "PipelineProfiler"
    },
    "pipelineFilterPattern": {
      "description": "Regex include/exclude pipelines for profiling.",
      "$ref": "../type/filterPattern.json#/definitions/filterPattern",
      "title": "Pipeline Filter Pattern"
    },
    "tableFilterPattern": {
      "description": "Regex include/exclude tables for profiling based on pipeline outputs.",
      "$ref": "../type/filterPattern.json#/definitions/filterPattern", 
      "title": "Table Filter Pattern"
    },
    "maxRunsToProfile": {
      "description": "Maximum number of recent pipeline runs to profile for observability data",
      "type": "integer",
      "default": 10,
      "minimum": 1,
      "maximum": 100,
      "title": "Max Runs to Profile"
    },
    "profileSample": {
      "description": "Percentage of tables to profile. Value should be between 1 and 100",
      "type": "number",
      "default": 100,
      "minimum": 1,
      "maximum": 100,
      "title": "Profile Sample"
    },
    "includeFailedRuns": {
      "description": "Include failed pipeline runs in observability data",
      "type": "boolean",
      "default": false,
      "title": "Include Failed Runs"
    },
    "observabilityDays": {
      "description": "Number of days to look back for pipeline runs",
      "type": "integer", 
      "default": 7,
      "minimum": 1,
      "maximum": 30,
      "title": "Observability Days"
    },
    "dbServiceNames": {
      "title": "Database Service Names",
      "description": "List of Database Service Names for mapping pipeline observability to table entities",
      "type": "array",
      "items": {
        "type": "string"
      }
    }
  },
  "additionalProperties": false
}